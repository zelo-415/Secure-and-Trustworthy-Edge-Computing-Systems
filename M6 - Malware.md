more internals
 | quarter system cant get u enough time to do research lol

what if the sensors and hardware are operating correctly, are we safe then?
lets assume the sensor side (inputs) are all safe
: inject some malicious software into the program memory
##### how the adversary use malware to attack (3 ways)
- force the user to **download** a malicious file
- inject and/or execute a malicious **application**: trick the system to run the app / injection
- **reprogramming** the system: multi-stage attack
summary: corrupt the **memory** to run a malicious sequence of instructions (inject/rerun) - malware
goals: CIA, another way
##### types of malware
any piece of software created with the intent to cause harm
![[Pasted image 20250302144138.png]]
some for spreading some for creating damage, some both
###### virus
attach itself to a benign program
stay dormant mostly until it reaches the host or being activated, spread the intended damage
*2000: ILOVEYOU virus. txt.VBS file: visual basic script*
- social engineering
- execution of malicious script: rewrite system files, create hidden copies of itself in system directories, at that time WSH operate automatically
- self-propagation via outlook and reboot: sent itself to all contacts in the victims outlook address books, modify the windows registry to run every reboot!
mitigations: disabled WSH, patches, block suspicious emails
###### worms
spread itself automatically and **independently** of the host (virus need to attach to sth) - buffer overflow
*SQL slammer:*
- exploit a buffer overflow in SQL server
- self-replication and rapid spread, overload routers and networks within minutes
###### trojans
piece of software looks benign, but once its activated it creates damage: spy, data exfiltration
hardware trojan
dont spread themselves
 *Zbot* 
###### ransomware
encrpt the memory and ask for ransom to decrypt it
bitcoin
virus - ransomware or worm - ransomware
###### cryptominer
emerging type
stealing computer power for mining
###### bots/botnets
crawls the internet for finding vulnarable devices to hack to create an army of hacked devices - used to create a coordinated attack (DDoS attack)
###### adware and malvertising
annoying for the former and for downloading latter
###### spyware 
spy: keylogging, tracking
DarkHotel
###### Rootkit
root+kit: enable an attacker to access privileged parts
main hidden by moving itself around, give access to remote adversary
###### fileless malware
without the need to download anything
inject on-the-fly, jump to execute
reuse the code 
##### how to create malware
##### how to defend against malware
###### prevention 
- software and memory protection mechanism
- network protection
- best-practice
- **code analysis**: BEFORE running it, not just malware but also find ALL vulnerabilities
	- static analysis: scan mem, network, etc, to find known patterns
	- dynamic analysis: run (partial) code in very constrained env
###### detection:
- cant find all vulnerabilities (not known patterns) and/or the attacker might install/inject
- detect when they re running and stopping it immediately? - block not expected behaviours, signature-based systems (find patterns), verify the author
- monitor the behaviour of the system, obverve anomalous behaviour and report it 
###### anomaly detection:
- pick a list of program features
- build a 'reference' model using those features
- dynamically monitor the program execution and compare the current state with the 'reference' model
- if theres a deviation (using a metric), thats an anomaly potentially malware
###### case study
feasibility, key idea is hardware-related stats can be used to detect malware
intuition: hardware provides clear signature!
**how to build a detector:**
create a dataset: benign and malicious samples
also need a mechanism to run the malicious samples: isolation and sandboxing, hardware/software variability (have to run it)
classification of malware *classification metrics:*
- accuracy
- precision: how many are actual positive (tp/tp+fp) in predicted
- recall (sensitivity): how many positives are correctly identified (tp/tp+fn) in labels ground truth
- F1
for attacker: reverse engineered detector, like a GAN? to create a new and better malware (adversarial attack)
**more features:** network, RF signals, sw calls, jumps, hardware level, side-channels
**models:** SP, ML, DL, hybrid
what to do once an anomaly is detected: 
- report to higher hiearchy (avoid FP!)
- multi-level defense
- conservative vs. aggressive

inject / reuse the existing code